<%- include('../template/main/head', { titleWeb: 'Recuperación' , cssStyle: 'css/output.css' }) %>
<%- include('../template/main/navbar') %>

<style>
    /* ...estilos de fondo, overlay, animaciones, botones, inputs, iconos, etc. igual que en register.ejs... */
    body, html {
        height: 100%;
        margin: 0;
    }
    .background-image {
        position: fixed;
        top: 0; left: 0; right: 0; bottom: 0;
        background: url('https://images.unsplash.com/photo-1512820790803-83ca734da794?auto=format&fit=crop&w=1200&q=80') no-repeat center center/cover;
        z-index: -2;
    }
    .overlay {
        position: fixed;
        top: 0; left: 0; right: 0; bottom: 0;
        background-color: rgba(15, 23, 42, 0.75);
        z-index: -1;
    }
    @keyframes slideFadeIn {
        from { opacity: 0; transform: translateY(40px) scale(0.98);}
        to { opacity: 1; transform: translateY(0) scale(1);}
    }
    .animate-slideFadeIn {
        animation: slideFadeIn 0.7s cubic-bezier(.4, 1.7, .6, 0.8) both;
    }
    .btn-animated {
        background: linear-gradient(90deg, #06b6d4 0%, #818cf8 100%);
        background-size: 200% 200%;
        transition: background-position 0.4s, box-shadow 0.3s, transform 0.2s;
        box-shadow: 0 4px 32px 0 rgba(129, 140, 248, 0.15);
    }
    .btn-animated:hover, .btn-animated:focus {
        background-position: right center;
        box-shadow: 0 8px 40px 0 rgba(6, 182, 212, 0.25);
        transform: scale(1.05) translateY(-2px);
    }
    .input-animated:focus {
        box-shadow: 0 0 0 3px #818cf8aa;
        border-color: #818cf8;
        transition: box-shadow 0.3s, border-color 0.3s;
    }
    .input-icon {
        position: absolute;
        left: 0.75rem;
        top: 50%;
        transform: translateY(-50%);
        color: #06b6d4;
        font-size: 1.15rem;
        pointer-events: none;
    }
    .pl-icon {
        padding-left: 2.2rem !important;
    }
    .login-underline {
        position: relative;
        transition: color 0.2s;
    }
    .login-underline::after {
        content: "";
        position: absolute;
        left: 0; right: 0; bottom: -2px;
        height: 2px;
        background: linear-gradient(90deg, #06b6d4, #818cf8);
        border-radius: 2px;
        transform: scaleX(0);
        transition: transform 0.3s;
        transform-origin: left;
    }
    .login-underline:hover::after, .login-underline:focus::after {
        transform: scaleX(1);
    }
</style>

<div class="background-image"></div>
<div class="overlay"></div>

<div class="min-h-screen flex items-center justify-center px-4 mt-8 mb-8">
    <div class="w-full max-w-lg bg-indigo-900 bg-opacity-95 p-8 rounded-3xl shadow-2xl border-2 border-indigo-700 animate-slideFadeIn relative">
        <h2 class="text-3xl font-extrabold text-center text-indigo-100 mb-6 tracking-tight drop-shadow flex items-center justify-center gap-3">
            <i class="bi bi-key-fill text-cyan-400 text-2xl"></i>
            Recuperar contraseña
        </h2>
        <form action="/auth/forgot-password" method="POST" class="space-y-7 text-base" autocomplete="off" id="forgotForm">
            <div>
                <label class="block text-indigo-200 font-semibold mb-2">¿Cómo quieres recuperar tu contraseña?</label>
                <div class="flex gap-6 mb-2">
                    <label class="inline-flex items-center text-indigo-200 font-medium">
                        <input type="radio" name="recover_method" value="email" checked
                            class="accent-cyan-500 mr-2" id="recoverByEmail">
                        Correo electrónico
                    </label>
                    <label class="inline-flex items-center text-indigo-200 font-medium">
                        <input type="radio" name="recover_method" value="phone"
                            class="accent-cyan-500 mr-2" id="recoverByPhone">
                        Número de teléfono
                    </label>
                </div>
            </div>
            <div id="emailField">
                <label for="email" class="block text-indigo-200 font-semibold mb-1">Correo electrónico</label>
                <div class="relative">
                    <span class="input-icon">
                        <i class="bi bi-envelope-fill"></i>
                    </span>
                    <input type="email" id="email" name="email"
                        class="pl-icon w-full px-4 py-3 rounded-lg border border-indigo-700 bg-indigo-800 text-white shadow-inner focus:outline-none focus:ring-2 focus:ring-indigo-400 focus:border-indigo-400 transition input-animated"
                        placeholder="Ingresa tu correo electrónico" />
                </div>
            </div>
            <div id="phoneField" style="display:none;">
                <label for="phone" class="block text-indigo-200 font-semibold mb-1">Número de teléfono</label>
                <div class="relative">
                    <span class="input-icon">
                        <i class="bi bi-phone-fill"></i>
                    </span>
                    <input type="tel" id="phone" name="phone"
                        class="pl-icon w-full px-4 py-3 rounded-lg border border-indigo-700 bg-indigo-800 text-white shadow-inner focus:outline-none focus:ring-2 focus:ring-indigo-400 focus:border-indigo-400 transition input-animated"
                        placeholder="Ingresa tu número de teléfono" />
                </div>
            </div>
            <button type="submit"
                class="w-full btn-animated text-white font-bold py-3 rounded-xl shadow-lg transition-all duration-300 text-lg tracking-wide focus:outline-none focus:ring-4 focus:ring-cyan-300 flex justify-center items-center gap-2">
                <i class="bi bi-send-fill text-white text-xl"></i>
                Enviar enlace de recuperación
            </button>
        </form>
        <p class="mt-8 text-center text-sm text-indigo-200">
            ¿Recuerdas tu contraseña?
            <a href="/auth/login"
                class="login-underline text-cyan-400 hover:text-cyan-200 focus:outline-none focus:ring-2 focus:ring-cyan-500 rounded transition font-semibold">
                Inicia sesión
            </a>
        </p>
    </div>
</div>

<script>
    // Mostrar/ocultar campos según método seleccionado
    const recoverByEmail = document.getElementById('recoverByEmail');
    const recoverByPhone = document.getElementById('recoverByPhone');
    const emailField = document.getElementById('emailField');
    const phoneField = document.getElementById('phoneField');
    const forgotForm = document.getElementById('forgotForm');

    recoverByEmail.addEventListener('change', () => {
        if (recoverByEmail.checked) {
            emailField.style.display = '';
            phoneField.style.display = 'none';
        }
    });
    recoverByPhone.addEventListener('change', () => {
        if (recoverByPhone.checked) {
            emailField.style.display = 'none';
            phoneField.style.display = '';
        }
    });

    // Validación simple antes de enviar
    forgotForm.addEventListener('submit', function(e) {
        if (recoverByEmail.checked) {
            if (!forgotForm.email.value.trim()) {
                e.preventDefault();
                forgotForm.email.classList.add('ring-2', 'ring-red-500');
                alert('Por favor ingresa tu correo electrónico.');
            } else {
                forgotForm.email.classList.remove('ring-2', 'ring-red-500');
            }
        } else if (recoverByPhone.checked) {
            if (!forgotForm.phone.value.trim()) {
                e.preventDefault();
                forgotForm.phone.classList.add('ring-2', 'ring-red-500');
                alert('Por favor ingresa tu número de teléfono.');
            } else {
                forgotForm.phone.classList.remove('ring-2', 'ring-red-500');
            }
        }
    });
</script>

<%- include('../template/main/footer') %>